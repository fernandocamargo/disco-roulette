{"ast":null,"code":"import _slicedToArray from \"/Users/fernandocamargodelbuono/_dev/disco-roulette/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"/Users/fernandocamargodelbuono/_dev/disco-roulette/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n\nvar _jsxFileName = \"/Users/fernandocamargodelbuono/_dev/disco-roulette/src/components/app/render.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport { create } from \"axios\";\nimport { Fragment, useCallback, useEffect, useMemo, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport var USER = \"pr0n\";\nexport var client = create({\n  headers: {\n    \"user-agent\": \"ElMundoFrio/1.0\"\n  },\n  baseURL: \"https://api.discogs.com\"\n});\nexport var getFolders = function getFolders() {\n  return client.get(\"/users/\".concat(USER, \"/collection/folders\")).then(function (_ref) {\n    var folders = _ref.data.folders;\n    return folders;\n  });\n};\nexport var getReleases = function getReleases(_ref2) {\n  var id = _ref2.id,\n      _ref2$url = _ref2.url,\n      url = _ref2$url === void 0 ? \"/users/\".concat(USER, \"/collection/folders/\").concat(id, \"/releases\") : _ref2$url,\n      _ref2$stack = _ref2.stack,\n      current = _ref2$stack === void 0 ? [] : _ref2$stack;\n\n  var check = function check(_ref3) {\n    var _ref3$data = _ref3.data,\n        pagination = _ref3$data.pagination.urls.next,\n        releases = _ref3$data.releases;\n    var next = current.concat(releases);\n    return !pagination ? next : getReleases({\n      stack: next,\n      url: pagination\n    });\n  };\n\n  return client.get(url).then(check);\n};\nexport var flatten = function flatten(current, next) {\n  return current.concat(next);\n};\nexport var getInitialState = function getInitialState() {\n  return {\n    error: null,\n    index: null,\n    loading: true,\n    releases: []\n  };\n};\nexport var update = function update(next) {\n  return function (current) {\n    return Object.assign({}, current, next, {\n      loading: false\n    });\n  };\n};\nexport var random = function random(until) {\n  return Math.floor(Math.random() * until) + 1 - 1;\n};\nexport var Artist = function Artist(_ref4) {\n  var id = _ref4.id,\n      name = _ref4.name;\n  return /*#__PURE__*/_jsxDEV(\"a\", {\n    href: \"https://www.discogs.com/artist/\".concat(id),\n    title: name,\n    target: \"_blank\",\n    rel: \"noreferrer\",\n    children: name\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 3\n  }, _this);\n};\n_c = Artist;\nexport var renderArtist = function renderArtist(artist, index, _ref5) {\n  var length = _ref5.length;\n  var last = index === length - 1;\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Artist, _objectSpread({\n      last: last\n    }, artist), index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, _this), !last && /*#__PURE__*/_jsxDEV(\"span\", {\n      children: \" / \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 17\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, _this);\n};\nexport var Release = function Release(props) {\n  var _props$basic_informat = props.basic_information,\n      artists = _props$basic_informat.artists,\n      id = _props$basic_informat.id,\n      title = _props$basic_informat.title;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: [/*#__PURE__*/_jsxDEV(Fragment, {\n        children: [artists.map(renderArtist), \" - \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"a\", {\n        href: \"https://www.discogs.com/release/\".concat(id),\n        title: title,\n        target: \"_blank\",\n        rel: \"noreferrer\",\n        children: title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"pre\", {\n      children: JSON.stringify(props, null, 2)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, _this);\n};\n_c2 = Release;\nexport default _s(function () {\n  _s();\n\n  var _useState = useState(getInitialState()),\n      _useState2 = _slicedToArray(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  var fail = useCallback(function (_ref6) {\n    var error = _ref6.message;\n    return setState(update({\n      error: error\n    }));\n  }, []);\n  var set = useCallback(function (response) {\n    var releases = response.reduce(flatten);\n    var index = random(releases.length);\n    return setState(update({\n      index: index,\n      releases: releases\n    }));\n  }, []);\n  var succeed = useCallback(function (folders) {\n    return Promise.all(folders.map(getReleases)).then(set);\n  }, [set]);\n  var shuffle = useCallback(function () {\n    return setState(update({\n      index: random(state.releases.length)\n    }));\n  }, [state.releases]);\n  var release = useMemo(function () {\n    return state.releases[state.index];\n  }, [state]);\n  useEffect(function () {\n    getFolders().then(succeed).catch(fail);\n  }, [fail, succeed]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: shuffle,\n      children: \"Shuffle\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, _this), !!release && /*#__PURE__*/_jsxDEV(Release, _objectSpread({}, release), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 21\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 123,\n    columnNumber: 5\n  }, _this);\n}, \"kHmtZr2OQABv64WxX3xwfM2Nx5k=\");\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Artist\");\n$RefreshReg$(_c2, \"Release\");","map":{"version":3,"sources":["/Users/fernandocamargodelbuono/_dev/disco-roulette/src/components/app/render.js"],"names":["create","Fragment","useCallback","useEffect","useMemo","useState","USER","client","headers","baseURL","getFolders","get","then","folders","data","getReleases","id","url","stack","current","check","pagination","urls","next","releases","concat","flatten","getInitialState","error","index","loading","update","Object","assign","random","until","Math","floor","Artist","name","renderArtist","artist","length","last","Release","props","basic_information","artists","title","map","JSON","stringify","state","setState","fail","message","set","response","reduce","succeed","Promise","all","shuffle","release","catch"],"mappings":"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","sourcesContent":["import { create } from \"axios\";\nimport { Fragment, useCallback, useEffect, useMemo, useState } from \"react\";\n\nexport const USER = \"pr0n\";\n\nexport const client = create({\n  headers: { \"user-agent\": \"ElMundoFrio/1.0\" },\n  baseURL: \"https://api.discogs.com\"\n});\n\nexport const getFolders = () =>\n  client\n    .get(`/users/${USER}/collection/folders`)\n    .then(({ data: { folders } }) => folders);\n\nexport const getReleases = ({\n  id,\n  url = `/users/${USER}/collection/folders/${id}/releases`,\n  stack: current = []\n}) => {\n  const check = ({\n    data: {\n      pagination: {\n        urls: { next: pagination }\n      },\n      releases\n    }\n  }) => {\n    const next = current.concat(releases);\n\n    return !pagination ? next : getReleases({ stack: next, url: pagination });\n  };\n\n  return client.get(url).then(check);\n};\n\nexport const flatten = (current, next) => current.concat(next);\n\nexport const getInitialState = () => ({\n  error: null,\n  index: null,\n  loading: true,\n  releases: []\n});\n\nexport const update = (next) => (current) =>\n  Object.assign({}, current, next, { loading: false });\n\nexport const random = (until) => Math.floor(Math.random() * until) + 1 - 1;\n\nexport const Artist = ({ id, name }) => (\n  <a\n    href={`https://www.discogs.com/artist/${id}`}\n    title={name}\n    target=\"_blank\"\n    rel=\"noreferrer\"\n  >\n    {name}\n  </a>\n);\n\nexport const renderArtist = (artist, index, { length }) => {\n  const last = index === length - 1;\n\n  return (\n    <Fragment>\n      <Artist key={index} last={last} {...artist} />\n      {!last && <span> / </span>}\n    </Fragment>\n  );\n};\n\nexport const Release = (props) => {\n  const {\n    basic_information: { artists, id, title }\n  } = props;\n\n  return (\n    <div>\n      <h1>\n        <Fragment>{artists.map(renderArtist)} - </Fragment>\n        <a\n          href={`https://www.discogs.com/release/${id}`}\n          title={title}\n          target=\"_blank\"\n          rel=\"noreferrer\"\n        >\n          {title}\n        </a>\n      </h1>\n      <pre>{JSON.stringify(props, null, 2)}</pre>\n    </div>\n  );\n};\n\nexport default () => {\n  const [state, setState] = useState(getInitialState());\n  const fail = useCallback(\n    ({ message: error }) => setState(update({ error })),\n    []\n  );\n  const set = useCallback((response) => {\n    const releases = response.reduce(flatten);\n    const index = random(releases.length);\n\n    return setState(update({ index, releases }));\n  }, []);\n  const succeed = useCallback(\n    (folders) => Promise.all(folders.map(getReleases)).then(set),\n    [set]\n  );\n  const shuffle = useCallback(\n    () => setState(update({ index: random(state.releases.length) })),\n    [state.releases]\n  );\n  const release = useMemo(() => state.releases[state.index], [state]);\n\n  useEffect(() => {\n    getFolders().then(succeed).catch(fail);\n  }, [fail, succeed]);\n\n  return (\n    <div>\n      <button onClick={shuffle}>Shuffle</button>\n      {!!release && <Release {...release} />}\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}