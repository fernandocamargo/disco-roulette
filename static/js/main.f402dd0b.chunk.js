(this["webpackJsonpdisco-roulette"]=this["webpackJsonpdisco-roulette"]||[]).push([[0],{124:function(n,e,t){"use strict";t.r(e);var r={};t.r(r),t.d(r,"displayName",(function(){return m})),t.d(r,"defaultProps",(function(){return O})),t.d(r,"propTypes",(function(){return g}));var c={};t.r(c),t.d(c,"displayName",(function(){return k})),t.d(c,"defaultProps",(function(){return w})),t.d(c,"propTypes",(function(){return N}));var i={};t.r(i),t.d(i,"displayName",(function(){return T})),t.d(i,"defaultProps",(function(){return M})),t.d(i,"propTypes",(function(){return A}));var o={};t.r(o),t.d(o,"displayName",(function(){return X})),t.d(o,"defaultProps",(function(){return H})),t.d(o,"propTypes",(function(){return nn}));var a={};t.r(a),t.d(a,"displayName",(function(){return rn})),t.d(a,"defaultProps",(function(){return cn})),t.d(a,"propTypes",(function(){return on}));var s={};t.r(s),t.d(s,"displayName",(function(){return sn}));var u,l,d,f,b=t(0),j=t(40),p=t(3),h=t(1),m="Artist",O={},g={},v=Object.assign((function(n){var e=n.id,t=(n.last,n.name);return Object(h.jsx)(C,{href:"//discogs.com/artist/".concat(e),title:t,children:t})}),r),x=t(48),y=t(4),k="Link",w={target:"_blank",rel:"noreferrer"},N={children:y.node.isRequired,href:y.string.isRequired},C=Object.assign((function(n){var e=n.children,t=Object(x.a)(n,["children"]);return Object(h.jsx)("a",Object(p.a)(Object(p.a)({},t),{},{children:e}))}),c),P=function(n,e){return Object(h.jsx)("li",{children:Object(h.jsx)(v,Object(p.a)({},n))},e)},T="Release",M={},A={},L=t(15),S=t(5),z=t(41),R=t.n(z),B=t(6),E=function(n){return"".concat(n,"px ").concat(n,"px 0 0 #ccc")},I=(l=Object.assign((function(n){var e=n.className,t=n.artists,r=n.id,c=n.title;return Object(h.jsxs)("article",{className:e,children:[Object(h.jsxs)("dl",{"aria-roledescription":"artists",children:[Object(h.jsx)("dt",{children:"Artist(s)"}),Object(h.jsx)("dd",{children:Object(h.jsx)("ul",{children:t.map(P)})})]}),Object(h.jsxs)("dl",{"aria-roledescription":"title",children:[Object(h.jsx)("dt",{children:"Title"}),Object(h.jsx)("dd",{children:Object(h.jsx)(C,{href:"//discogs.com/release/".concat(r),title:c,children:c})})]})]})}),i),Object(B.b)(l)(u||(u=Object(S.a)(["\n  font-family: 'PT Mono', monospace;\n  font-size: 1.25rem;\n  bottom: 1.5rem;\n  margin: 0 0 0 1rem;\n  position: absolute;\n  right: 1.5rem;\n\n  &:before {\n    background: url(",") center\n      no-repeat;\n    background-size: cover;\n    content: '';\n    display: block;\n    height: 100%;\n    left: 0;\n    position: fixed;\n    top: 0;\n    width: 100%;\n  }\n\n  dl {\n    display: block;\n\n    &[aria-roledescription='title'] {\n      a {\n        background-color: #fff;\n        color: #000;\n      }\n    }\n  }\n\n  dt {\n    display: none;\n  }\n\n  dd {\n    text-align: right;\n  }\n\n  a {\n    background-color: #000;\n    box-shadow: inset 0 -4px 0 0 rgba(0, 0, 0, 0.2),\n      ",";\n    color: #fff;\n    display: inline-block;\n    padding: 0.5rem 1rem;\n    position: relative;\n    text-decoration: none;\n  }\n"])),(function(n){var e=Object(L.a)(n.images,1)[0].uri;return CSS.escape(e)}),R()(24,E).join(", "))),_=t(45),U=function(){return Object(b.useMemo)((function(){return Object(_.create)({headers:{Authorization:"Discogs key=CBYXakYdVQNblmGsSsKu, secret=oitbBZUwWnyWNIQZeLagsBAwjcyDosmo","User-Agent":"disco-roulette/1.0"},baseURL:"https://api.discogs.com/users/".concat(window.location.pathname.trim().toLowerCase().substr(1)||"pr0n")})}),[])},$=t(14),q=t.n($),D=q()("data.folders"),J=q()("data"),Q=function(n,e){return n.concat(e)},W=function(n){return Math.floor(Math.random()*n)+1-1},Y=t(13),Z=t(46),F=t.n(Z),G=function(n){var e=n.release,t=n.releases;return function(n){return F()(n,Object(p.a)(Object(p.a)({},!!e&&{history:{$push:[e.id]},release:Object(Y.a)({},e.id,{$set:e})}),!!t&&{releases:{$set:t}}))}},K=function(){var n=Object(b.useState)({history:[],release:{},releases:[]}),e=Object(L.a)(n,2),t=e[0],r=e[1],c=function(){var n=U().get;return Object(b.useCallback)((function(){return n("/collection/folders").then(D)}),[n])}(),i=function(){var n=U().get;return Object(b.useCallback)((function(e){var t=e.resource_url;return n(t).then(J)}),[n])}(),o=function(){var n=U().get,e=Object(b.useCallback)((function(t){var r=t.id,c=t.url,i=void 0===c?"/collection/folders/".concat(r,"/releases"):c,o=t.stack,a=void 0===o?[]:o;return n(i).then((function(n){var t=n.data,r=t.pagination.urls.next,c=t.releases,i=a.concat(c);return r?e({stack:i,url:r}):i}))}),[n]);return e}(),a=Object(b.useCallback)((function(n){var e=n.message;return console.log({error:e})}),[]),s=Object(b.useCallback)((function(n){return Promise.all(n.map(o)).then((function(n){var e=n.reduce(Q),t=W(e.length),c=e[t].basic_information;return i(c).then((function(n){var t=n.images.find((function(n){return!!n.uri}));return new Promise((function(n){return Object.assign(new Image,{src:t.uri}).addEventListener("load",n,!0)})).then((function(){return r(G({release:n,releases:e}))}))}))}))}),[i,o]),u=Object(b.useCallback)((function(){var n=W(t.releases.length),e=t.releases[n].basic_information;return i(e).then((function(n){var e=n.images.find((function(n){return!!n.uri}));return new Promise((function(n){return Object.assign(new Image,{src:e.uri}).addEventListener("load",n,!0)})).then((function(){return r(G({release:n}))}))}))}),[t.releases,i]),l=Object(b.useCallback)((function(){return c().then(s).catch(a)}),[a,c,s]),d=Object(b.useMemo)((function(){return t.history.map((function(n){return t.release[n]}))}),[t.history,t.release]);return Object(b.useEffect)((function(){l()}),[l]),{releases:d,shuffle:u}},V=function(n){return Object(h.jsx)(I,Object(p.a)({},n),n.id)},X="App",H={},nn={},en=function(n){return Object(B.b)(n)(d||(d=Object(S.a)(["\n  align-items: center;\n  display: flex;\n  height: 100%;\n  justify-content: center;\n  overflow: hidden;\n  position: relative;\n\n  button {\n    background-color: red;\n    border: none;\n    color: white;\n    cursor: pointer;\n    display: inline-block;\n    font-family: 'PT Mono', monospace;\n    font-size: 1.5rem;\n    padding: 0.5rem 1rem;\n    position: absolute;\n    right: 1rem;\n    top: 1rem;\n    z-index: 1;\n  }\n\n  "," {\n    &:not(:last-of-type) {\n      display: none;\n    }\n  }\n"])),I)}(Object.assign((function(n){var e=n.className,t=K(),r=t.releases,c=t.shuffle;return Object(h.jsxs)(b.Fragment,{children:[Object(h.jsx)(ln,{}),Object(h.jsxs)("div",{className:e,children:[Object(h.jsx)("button",{onClick:c,children:"Shuffle"}),r.map(V)]})]})}),o)),tn=t(47),rn="Root",cn={},on={},an=Object.assign((function(){return Object(h.jsx)(tn.a,{children:Object(h.jsx)(en,{})})}),a),sn="\ud83e\udde9",un=Object(B.a)(f||(f=Object(S.a)(["\n  html {\n    background-color: #fff;\n    opacity: 1;\n  }\n\n  main#root {\n    height: 100vh;\n  }\n\n  figure {\n    margin: 0;\n  }\n"]))),ln=Object.assign(un,s);e.default=Object(j.render)(Object(h.jsx)(b.StrictMode,{children:Object(h.jsx)(an,{})}),document.getElementById("root"))}},[[124,1,2]]]);
//# sourceMappingURL=main.f402dd0b.chunk.js.map